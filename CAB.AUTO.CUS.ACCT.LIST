    SUBROUTINE CAB.AUTO.CUS.ACCT.LIST
    $INCLUDE T24.BP I_COMMON
    $INCLUDE T24.BP I_EQUATE
    $INCLUDE T24.BP I_F.CUSTOMER.ACCOUNT
    $INCLUDE T24.BP I_System
    $INCLUDE T24.BP I_GTS.COMMON
    $INCLUDE T24.BP I_F.FUNDS.TRANSFER
    $INCLUDE T24.BP I_F.ACCOUNT

    FN.CUSTOMER.ACCOUNT = 'F.CUSTOMER.ACCOUNT'
    FV.CUSTOMER.ACCOUNT = ''
    CALL OPF(FN.CUSTOMER.ACCOUNT,FV.CUSTOMER.ACCOUNT)

    FN.ACCOUNT = 'F.ACCOUNT'
    F.ACCOUNT = ''
    CALL OPF(FN.ACCOUNT,F.ACCOUNT)

    CUSTOMER.NUMBER = ''
    R.CUSTOMER.ACCOUNT = ''
    ERR.ACC = ''
    YR.LOC.REF.POS = ''
    Y.ACCOUNT.CNT = ''
    R.ACCOUNT = ''
    ACC.ERR = ''
    R.CUSTOMER.ACCOUNT.FINAL = ''
    YR.LOC.REF.FIELDS = 'CBSTXNREF'
    CALL MULTI.GET.LOC.REF("FUNDS.TRANSFER",YR.LOC.REF.FIELDS,YR.LOC.REF.POS)
    Y.CBSTXNREF.POS = YR.LOC.REF.POS<1,1>
    CUSTOMER.NUMBER = R.NEW(FT.LOCAL.REF)<1,Y.CBSTXNREF.POS>
    CALL F.READ(FN.CUSTOMER.ACCOUNT,CUSTOMER.NUMBER,R.CUSTOMER.ACCOUNT,FV.CUSTOMER.ACCOUNT,ERR.ACC)
    Y.TOT.ACCOUNT.CNT = DCOUNT(R.CUSTOMER.ACCOUNT,FM)
    FOR Y.ACCT.ACT = 1 TO Y.TOT.ACCOUNT.CNT
        CALL F.READ(FN.ACCOUNT,R.CUSTOMER.ACCOUNT<Y.ACCT.ACT>,R.ACCOUNT,F.ACCOUNT,ACC.ERR)
        IF R.ACCOUNT<AC.CATEGORY> MATCHES '1001':VM:'1002':VM:'1003':VM:'1100':VM:'1101':VM:'6001':VM:'1010':VM:'1022' THEN
            R.CUSTOMER.ACCOUNT.FINAL<-1> = R.CUSTOMER.ACCOUNT<Y.ACCT.ACT>
        END
    NEXT Y.ACCT.ACT
    CONVERT FM TO SM IN R.CUSTOMER.ACCOUNT.FINAL
    WRITELIST R.CUSTOMER.ACCOUNT.FINAL TO "R.CUSTOMER.ACCOUNT.FINAL"
    CALL System.setVariable("EXT.SMS.ACCOUNTS",R.CUSTOMER.ACCOUNT.FINAL)
    CALL System.saveVariables

    RETURN
END
